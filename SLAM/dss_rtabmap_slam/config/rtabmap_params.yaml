# RTAB-Map Configuration for DSS Platform

rtabmap:
  ros__parameters:
    # Frame IDs
    frame_id: "base_link"
    map_frame_id: "map"
    odom_frame_id: "odom"

    # Input topics
    subscribe_depth: false
    subscribe_rgb: false
    subscribe_scan_cloud: true

    # TF
    publish_tf: true
    wait_for_transform: 0.2

    # Synchronization
    approx_sync: false

    # Memory
    Mem/IncrementalMemory: "true"
    Mem/InitWMWithAllNodes: "false"

    # ICP Parameters
    Icp/VoxelSize: "0.1"
    Icp/MaxCorrespondenceDistance: "1.0"
    Icp/PointToPlaneK: "5"
    Icp/PointToPlaneRadius: "0"
    Icp/MaxTranslation: "2.0"
    Icp/Epsilon: "0.001"
    Icp/PointToPlane: "true"
    Icp/Iterations: "10"
    Icp/CorrespondenceRatio: "0.2"

    # Odometry
    Odom/Strategy: "0"  # 0=Frame-to-Map, 1=Frame-to-Frame
    Odom/GuessMotion: "true"
    OdomF2M/ScanSubtractRadius: "0.1"
    OdomF2M/ScanMaxSize: "15000"

    # Registration
    Reg/Strategy: "1"  # 0=Visual, 1=ICP, 2=Visual+ICP

    # Loop Closure
    RGBD/ProximityBySpace: "true"
    RGBD/ProximityMaxGraphDepth: "0"
    RGBD/ProximityPathMaxNeighbors: "10"
    RGBD/AngularUpdate: "0.05"  # rad
    RGBD/LinearUpdate: "0.05"   # m

    # Graph Optimization
    RGBD/OptimizeFromGraphEnd: "false"
    Optimizer/Epsilon: "0.00001"
    Optimizer/Iterations: "100"
    Optimizer/Slam2D: "false"  # Set to true for 2D SLAM

icp_odometry:
  ros__parameters:
    frame_id: "base_link"
    odom_frame_id: "odom"
    publish_tf: true
    wait_for_transform: 0.2
    approx_sync: false

    # ICP Odometry
    Icp/VoxelSize: "0.1"
    Icp/MaxCorrespondenceDistance: "1.0"
    Icp/PointToPlaneK: "5"
    Icp/PointToPlaneRadius: "0"
    Icp/MaxTranslation: "2.0"
    Icp/Epsilon: "0.001"
    Icp/PointToPlane: "true"
    Icp/Iterations: "10"
    Icp/CorrespondenceRatio: "0.2"

    Odom/Strategy: "0"
    Odom/GuessMotion: "true"
    OdomF2M/ScanSubtractRadius: "0.1"
    OdomF2M/ScanMaxSize: "15000"
